# This is an example configuration file for defining notifiers.
# Notifiers define what happens when a monitor's filter script returns true.
# You can copy this file to `notifiers.yaml` and update `config.yaml` to point to it.

notifiers:
  # ------------------------------------------------------------------------------------
  # EXAMPLE 1: Generic Webhook
  #
  # This trigger sends a POST request to a generic webhook endpoint.
  # It includes an optional secret for HMAC-SHA256 signature verification.
  # ------------------------------------------------------------------------------------
  - name: "my-generic-webhook"
    webhook:
      # The URL of your webhook endpoint.
      url: "https://my-service.com/webhook-endpoint"
      # The HTTP method to use. Defaults to "POST".
      method: "POST"
      # (Optional) A secret key to sign the request payload.
      # If provided, Argus will compute an HMAC-SHA256 signature of the payload
      # and include it in the `X-Signature` header. The `X-Timestamp` header
      # will also be included.
      # The signature is computed as: hex(hmac_sha256(payload_body + timestamp, secret))
      secret: "your-super-secret-webhook-secret"
      # (Optional) Custom headers to include in the request.
      headers:
        Authorization: "Bearer your-auth-token"
        X-Custom-Header: "custom-value"
      # The message to send. Both `title` and `body` support templating.
      message:
        title: "New Transaction Alert: {{ monitor_name }}"
        # The body can use any data from the monitor match:
        # monitor_id, block_number, transaction_hash, contract_address, notifier_name,
        # log_index, log_name, log_params (for log matches),
        body: |
          A new match was detected for monitor {{ monitor_name }}.
          - **Block Number**: {{ block_number }}
          - **Transaction Hash**: {{ transaction_hash }}
          {% if type == "log" %}
          - **Type**: Log
          - **Contract Address**: {{ contract_address }}
          - **Log Index**: {{ log_index }}
          - **Log Name**: {{ log_name }}
          - **Log Params**: {{ log_params }}
          {% endif %}

  # ------------------------------------------------------------------------------------
  # EXAMPLE 2: Slack Notification
  #
  # This trigger sends a message to a Slack channel via an Incoming Webhook.
  # ------------------------------------------------------------------------------------
  - name: "slack-notifications"
    slack:
      # Your Slack Incoming Webhook URL.
      slack_url: "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"
      message:
        title: "Large USDC Transfer Detected"
        # You can use markdown in the body.
        # The `trigger_data` here would come from the "Large USDC Transfers" monitor.
        # For example, if the filter script returns a map like `#{ from: log.params.from, to: log.params.to, value: log.params.value }`
        body: |
          A transfer of over 1,000,000 USDC was detected by monitor {{ monitor_name }}.
          - *From*: `{{ from }}`
          - *To*: `{{ to }}`
          - *Value*: `{{ value }}`
          <https://etherscan.io/tx/{{ transaction_hash }}|View on Etherscan>

  # ------------------------------------------------------------------------------------
  # EXAMPLE 3: Discord Notification
  #
  # This trigger sends a message to a Discord channel via a webhook.
  # ------------------------------------------------------------------------------------
  - name: "discord-alerts"
    discord:
      # Your Discord Webhook URL.
      discord_url: "https://discord.com/api/webhooks/000000000000000000/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
      message:
        title: "WETH Deposit Event"
        body: |
          A new WETH deposit was detected on Ethereum by monitor {{ monitor_name }}.
          - **Transaction**: `{{ transaction_hash }}`
          - **Block**: {{ block_number }}
          - **Contract Address**: {{ contract_address }}
          - **Log Name**: {{ name }}

  # ------------------------------------------------------------------------------------
  # EXAMPLE 4: Telegram Notification
  #
  # This trigger sends a message to a Telegram chat via a bot.
  # ------------------------------------------------------------------------------------
  - name: "telegram-updates"
    telegram:
      # Your Telegram Bot Token.
      token: "0000000000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
      # The ID of the chat to send the message to.
      chat_id: "-1000000000000"
      # (Optional) Disable the web page preview for links in the message.
      disable_web_preview: true
      message:
        title: "Large Native Token Transfer"
        # Telegram uses a specific version of Markdown (MarkdownV2).
        # Argus will automatically escape special characters for you.
        body: |
          A transfer of over 10 ETH was detected by monitor {{ monitor_name }}.
          - *Value*: {{ value }} ETH
          - *From*: `{{ from }}`
          - *To*: `{{ to }}`
          [View on Etherscan](https://etherscan.io/tx/{{ transaction_hash }})

  # ------------------------------------------------------------------------------------
  # EXAMPLE 5: Trigger with Custom Retry Policy
  #
  # All triggers support a custom retry policy.
  # ------------------------------------------------------------------------------------
  - name: "webhook-with-custom-retry-policy"
    webhook:
      url: "https://my-flaky-service.com/webhook"
      message:
        title: "Notification with Custom Retry Policy for monitor {{ monitor_name }}"
        body: |
          This notification for monitor {{ monitor_name }}
          Block: {{ block_number }}
          Transaction: {{ transaction_hash }}
      # (Optional) Custom retry policy.
      retry_policy:
        # Maximum number of retries.
        max_retries: 5
        # Initial delay between retries in milliseconds.
        initial_delay_ms: 100
        # Factor by which the delay increases after each retry (e.g., 2.0 for exponential backoff).
        backoff_factor: 2.0
